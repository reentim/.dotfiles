#!/usr/bin/env bash

# Finds the best tmux pane in a given target window to be the recipient of
# `tmux send-keys`

set -o pipefail

[ -z $1 ] && exit 1
target_window="$1"
shift

function main {
  tmux list-panes -t $target_window -F "#{pane_height},#{pane_current_command},#D,#{pane_active}" |
    grep "make\|bash\|zsh" | # running a shell
    sort -r                |
    head -1                |
    cut -d , -f 3            # split on comma, take third field (pane id)
}

main
